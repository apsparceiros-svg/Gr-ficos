<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gr√°ficos Profissionais - Im√≥veis</title>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  google.charts.load('current', {packages:['corechart', 'bar']});
  google.charts.setOnLoadCallback(drawCharts);

  function drawCharts() {
    // üîπ Substitua pelo link "Publicar na Web" da sua planilha
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQP-T1jc4Rpdigxqpkf7cL0MYiA8IESg1ATBwVdT7gTTPaMll_LGuwj0zOfbeEIO8Qv3DOZsK6eNBrZ/pub?gid=11391417&single=true&output=csv/gviz/tq?sheet=Im√≥veis&tq=";

    // Consultas individuais para cada gr√°fico
    const queries = {
      bairro: "SELECT F, AVG(G) GROUP BY F",         // Bairro x Pre√ßo m√©dio
      operacao: "SELECT C, AVG(G) GROUP BY C",      // Opera√ß√£o x Pre√ßo m√©dio
      tipo: "SELECT D, AVG(G) GROUP BY D",          // Tipo x Pre√ßo m√©dio
      cidade: "SELECT E, AVG(G) GROUP BY E",        // Cidade x Pre√ßo m√©dio
      operacao_tipo: "SELECT C, D, AVG(G) GROUP BY C, D" // Opera√ß√£o + Tipo x Pre√ßo m√©dio
    };

    for (let key in queries) {
      const query = new google.visualization.Query(sheetUrl + encodeURIComponent(queries[key]));
      query.send(response => handleResponse(response, key));
    }
  }

  function handleResponse(response, chartKey) {
    if (response.isError()) {
      console.error("Erro: " + response.getMessage());
      return;
    }
    const data = response.getDataTable();

    let options = { 
      backgroundColor: '#f4f4f4', 
      colors: ['#e67e22', '#3498db', '#2ecc71', '#9b59b6', '#f39c12'], 
      is3D: true 
    };
    let chartDiv = "";

    switch(chartKey) {
      case "bairro":
        options.title = "Pre√ßo M√©dio por Bairro";
        options.hAxis = {title: "Bairro"};
        options.vAxis = {title: "Pre√ßo M√©dio (R$)"};
        chartDiv = "chart_div1";
        break;
      case "operacao":
        options.title = "Pre√ßo M√©dio por Opera√ß√£o";
        options.hAxis = {title: "Opera√ß√£o"};
        options.vAxis = {title: "Pre√ßo M√©dio (R$)"};
        chartDiv = "chart_div2";
        break;
      case "tipo":
        options.title = "Pre√ßo M√©dio por Tipo";
        options.hAxis = {title: "Tipo"};
        options.vAxis = {title: "Pre√ßo M√©dio (R$)"};
        chartDiv = "chart_div4";
        break;
      case "cidade":
        options.title = "Pre√ßo M√©dio por Cidade";
        options.hAxis = {title: "Cidade"};
        options.vAxis = {title: "Pre√ßo M√©dio (R$)"};
        chartDiv = "chart_div5";
        break;
      case "operacao_tipo":
        options.title = "Opera√ß√£o + Tipo x Pre√ßo";
        options.hAxis = {title: "Opera√ß√£o + Tipo"};
        options.vAxis = {title: "Pre√ßo (R$)"};
        chartDiv = "chart_div3";
        break;
    }

    const chart = new google.visualization.ColumnChart(document.getElementById(chartDiv));
    chart.draw(data, options);
  }
</script>
<style>
  body { font-family: 'Roboto', sans-serif; background:#f4f4f9; color:#333; margin:0; padding:0; }
  .wrapper { display:flex; flex-direction:column; align-items:center; padding:30px; gap:40px; }
  .chart-container { width:100%; max-width:900px; }
  h2 { text-align:center; color:#8e44ad; margin-bottom:20px; }
  .chart-container > div { width:100%; height:500px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.1); margin-top:20px; }
</style>
</head>
<body>
  <div class="wrapper">
    <div class="chart-container">
      <h2>Gr√°ficos Profissionais - Im√≥veis</h2>
      <div id="chart_div1"></div>
      <div id="chart_div2"></div>
      <div id="chart_div3"></div>
      <div id="chart_div4"></div>
      <div id="chart_div5"></div>
    </div>
  </div>
</body>
</html>
