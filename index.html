<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Gráficos - Imóveis</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {packages:['corechart']});
    google.charts.setOnLoadCallback(drawCharts);

    function drawCharts() {
      const sheetUrl = "https://docs.google.com/spreadsheets/d/1GbiSQAuNfFcyx0YSj-8gxps7BpZkQdet6JR7BrxGq_k/gviz/tq?sheet=Imoveis";

      // preço médio por bairro (F, G)
      let q1 = new google.visualization.Query(sheetUrl + "&tq=" + encodeURIComponent("SELECT F, AVG(G) GROUP BY F"));
      q1.send(function(response) {
        if (response.isError()) { console.log(response.getMessage()); return; }
        let data = response.getDataTable();
        let chart = new google.visualization.ColumnChart(document.getElementById("chart_div1"));
        chart.draw(data, {title:"Preço Médio por Bairro", is3D:true});
      });

      // preço médio por operação (C, G)
      let q2 = new google.visualization.Query(sheetUrl + "&tq=" + encodeURIComponent("SELECT C, AVG(G) GROUP BY C"));
      q2.send(function(response) {
        if (response.isError()) { console.log(response.getMessage()); return; }
        let data = response.getDataTable();
        let chart = new google.visualization.ColumnChart(document.getElementById("chart_div2"));
        chart.draw(data, {title:"Preço Médio por Operação", is3D:true});
      });

      // operação + tipo (C, D, G)
      let q3 = new google.visualization.Query(sheetUrl + "&tq=" + encodeURIComponent("SELECT C, D, AVG(G) GROUP BY C, D"));
      q3.send(function(response) {
        if (response.isError()) { console.log(response.getMessage()); return; }
        let data = response.getDataTable();
        let chart = new google.visualization.BarChart(document.getElementById("chart_div3"));
        chart.draw(data, {title:"Operação e Tipo por Preço", is3D:true});
      });

      // preço médio por tipo (D, G)
      let q4 = new google.visualization.Query(sheetUrl + "&tq=" + encodeURIComponent("SELECT D, AVG(G) GROUP BY D"));
      q4.send(function(response) {
        if (response.isError()) { console.log(response.getMessage()); return; }
        let data = response.getDataTable();
        let chart = new google.visualization.ColumnChart(document.getElementById("chart_div4"));
        chart.draw(data, {title:"Preço Médio por Tipo", is3D:true});
      });

      // preço médio por cidade (E, G)
      let q5 = new google.visualization.Query(sheetUrl + "&tq=" + encodeURIComponent("SELECT E, AVG(G) GROUP BY E"));
      q5.send(function(response) {
        if (response.isError()) { console.log(response.getMessage()); return; }
        let data = response.getDataTable();
        let chart = new google.visualization.ColumnChart(document.getElementById("chart_div5"));
        chart.draw(data, {title:"Preço Médio por Cidade", is3D:true});
      });
    }
  </script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .chart { width: 100%; height: 400px; margin-bottom: 40px; }
  </style>
</head>
<body>
  <h2>Gráficos - Imóveis</h2>
  <div id="chart_div1" class="chart"></div>
  <div id="chart_div2" class="chart"></div>
  <div id="chart_div3" class="chart"></div>
  <div id="chart_div4" class="chart"></div>
  <div id="chart_div5" class="chart"></div>
</body>
</html>
